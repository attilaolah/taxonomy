(()=>{async function G(){const a=Promise.all([H(t("themes/mdn-yari.css")),H("https://cdnjs.cloudflare.com/ajax/libs/tabulator/5.2.7/css/tabulator_materialize.min.css","sha512-iNQ9peZHckZCzkkHjF4H6BsbP4W/gloaWm3SbnVXe5CY62LDVDRfvFpC7V2H+GpWsVP7IbfY/t7jjMYAy3bBFQ=="),P("https://cdnjs.cloudflare.com/ajax/libs/tabulator/5.2.7/js/tabulator.min.js","sha512-X+/BF5SW/6WTNbMtxDCRauCI+N4bd81XQFTTK+Eo4yveAFuEIGDzLV9zaxJLFYl5gzWmbMZb27c9k4fds22khA==")]),b=fetch(t("layout.html")),c=fetch(t("data/sources.json")),
d=fetch(t("data/common_names.json"));n.body.innerHTML=await (await b).text();n.title=n.body.querySelector("h1").innerText;await Q(c,d,a)}function t(a){return u.src.replace(/[^\/]+$/,a)}function v(a,b=!1,c=!1){const d=document.createElement("link");d.href=a;d.rel=b?"preconnect":"stylesheet";c&&(d.crossOrigin="");return d}function H(a,b=""){return new Promise((c,d)=>{const e=v(a);b&&(e.integrity=b,e.referrerPolicy="no-referrer",e.crossOrigin="anonymous");e.addEventListener("load",()=>{c(null)});e.addEventListener("error",
()=>{d()});q.appendChild(e)})}function P(a,b){return new Promise((c,d)=>{const e=document.createElement("script");e.integrity=b;e.referrerPolicy="no-referrer";e.crossOrigin="anonymous";e.src=a;e.addEventListener("load",()=>{c(null)});e.addEventListener("error",()=>{d()});q.appendChild(e)})}function Q(a,b,c){document.querySelector(".theme-switcher-menu .light-mode").addEventListener("click",()=>{document.body.className="light"});document.querySelector(".theme-switcher-menu .dark-mode").addEventListener("click",
()=>{document.body.className="dark"});document.getElementById("toggle-caps").addEventListener("click",()=>{document.getElementById("common-names").classList.toggle("toggle-caps")});document.getElementById("toggle-articles").addEventListener("click",()=>{document.getElementById("common-names").classList.toggle("toggle-articles")});document.getElementById("refresh-all").addEventListener("click",()=>{window.localStorage.clear();location.reload()});let d=!1;const e=document.getElementById("filter");document.body.addEventListener("keydown",
h=>{"/"!==h.key||d||(h.preventDefault(),e.focus(),d=!0)});e.addEventListener("blur",()=>{d=!1});a.then(async h=>{let f=1;for(let g of Object.entries(await h.json())){const [k,p]=g;A[k]=new R(k,f++,p)}});return new Promise(async()=>{for(let h of Object.entries(await (await b).json())){const [f,g]=h;g.forEach(k=>{k=new S(f,k);(l[k.j]=l[k.j]||[]).push(k)})}I.push(...Object.keys(l).map(h=>new T(h)));await Promise.all([a,c]);U()})}function U(){const a=Object.keys(l).length;document.querySelectorAll("[data-tpl]").forEach(b=>
{const c=b.dataset.tpl,d=/\{common_names.count\}/g;c.match(d)&&(b.innerText=c.replaceAll(d,a.toLocaleString("hu")))});["change","keyup"].forEach(b=>{document.getElementById("filter").addEventListener(b,V)});B=new window.Tabulator("#common-names .table",{data:I,pagination:!0,paginationSize:20,layout:"fitDataFill",rowHeight:80,rowFormatter:W,columns:[{field:"key",cssClass:"content flex-row",width:"100%",formatter:X}]})}function W(a){const b=a.getElement(),c=a.getData().key;setTimeout(()=>{Y(b,c)},50)}
function X(a){var b=a.getValue();const c=l[b];let d=document.createElement("div");d.className="common-names";let e=document.createElement("span");e.className="article";d.append(e);d.append(" ");let h=!0;c.map(g=>g.h.hu).reduce(w).filter(J).forEach(g=>{h&&(e.innerText=g?"A\u00c1E\u00c9I\u00cdO\u00d3\u00d6\u0150U\u00da\u00dc\u0170".includes(g[0].toUpperCase())?"az":"a":"");const k=document.createElement(h?"strong":"span");k.innerText=g;c.filter(p=>-1!=p.h.hu.indexOf(g)).forEach(p=>{const K=A[p.o],x=
document.createElement("sup");x.className="tooltip";x.dataset.tooltip=L(K,p.m);x.innerText=`[${K.B}]`;k.append(x)});d.append(k);h=!1});a=document.createElement("div");a.className="scientific-name";var f=document.createElement("em");f.innerText=b;a.append(f);b=c.map(g=>g.u).reduce(w).filter(J);b.length&&(a.append(" ("),f=document.createElement("span"),f.className="syn-marker",f.innerText="syn.",a.append(f),a.append(" "),f=document.createElement("em"),f.className="synonym",f.innerText=b.join(", "),
a.append(f),a.append(")"));b=document.createElement("div");b.className="photo material-symbols-outlined";b.innerText="downloading";f=document.createElement("div");f.className="flex-col";f.append(d);f.append(a);a=document.createElement("div");a.className="ext";return[b,f,a].map(g=>g.outerHTML).join("")}function L(a,b){let c=a.A;a.s&&(c+=` \u2014 ${a.s}`);return[c,"{page}. o.".replace(/\{page\}/,b.toLocaleString("hu"))].join("; ")}function w(a,b){return a.concat(b)}function J(a,b,c){return c.indexOf(a)===
b}function C(a,b){a=document.createElement(a);m(a,b);return a}function r(a,b,c){b=C(b,c);D(a,[b]);return b}function D(a,b){b.forEach(c=>{a.append(c)})}function m(a,b){b.forEach(c=>a.classList.add(c))}function V(a){y=a.target.value;E&&clearTimeout(E);setTimeout(()=>{E=0;M!==y&&B&&(M=y,B.setFilter(Z,{D:y}))},200)}function Z(a,b){return(b=b.D)?N(l[a.key].map(c=>c.h.hu.concat(c.j).concat(c.u)).reduce(w).join(" ")).includes(N(b)):!0}function N(a){return a.normalize("NFKD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}
async function O(a,b){const c=`${aa}/taxa?q=${encodeURIComponent(a)}&locale=${"hu"}&per_page=${b}`;var d=z[c];if(null===d)return null;void 0===d&&(d=window.localStorage.getItem(c),z[c]=d=d?new F(JSON.parse(d)):fetch(c));d instanceof F||(d=await (await d).json(),window.localStorage.setItem(c,JSON.stringify(d)),z[c]=d=new F(d));const e=d.v.find(h=>h.name===a);return e?e:!d.l||d.l<=b||200<=b?z[c]=null:await O(a,1<b?2*b:25)}async function Y(a,b){const c=await O(b,1),d=a.querySelector(".photo");c&&c.i?
(d.innerText="",d.style.backgroundImage=`url(${c.i.C})`,d.title=c.i.attribution.replace(/\(c\)/,"\u00a9").replaceAll(/\ball rights reserved\b/g,"minden jog fenntartva").replaceAll(/\bsome rights reserved\b/g,"n\u00e9h\u00e1ny jog fenntartva").replaceAll(/\buploaded by\b/g,"felt\u00f6lt\u00f6tte:")):(m(d,["missing"]),d.innerText="broken_image");ba(c,a,b)}function ba(a,b,c){function d(k){m(g,["tooltip"]);g.dataset.tooltip=k}b=r(b.querySelector(".ext"),"div",["chip","flex-row","inaturalist"]);var e=
r(b,"span",["material-symbols-outlined"]);const h=r(b,"a",["id","label"]),f=C("span",["material-symbols-outlined","last"]),g=C("span",["label","extra"]);e.innerText=a?"pin":"search";if(a)if(e=l[c].map(k=>k.h.hu).reduce(w).join(", "),h.innerText=a.id.toString(),h.href=`${"https://www.inaturalist.org"}/taxa/${a.id}`,a.g)D(b,[f,g]),a.g===e?(m(b,["match"]),f.innerText="done_all",d(`"${a.g}"`),g.innerText="n\u00e9v megegyezik"):a.g.toUpperCase()===e.toUpperCase()?(m(b,["near-match"]),f.innerText="done",
d(`"${a.g}"`),g.innerText="n\u00e9v hasonl\u00f3"):(m(b,["mismatch"]),f.innerText="emergency_home",d(`"${a.g}"`),g.innerText="n\u00e9v k\u00fcl\u00f6nb\u00f6zik");else{m(b,["missing"]);g.innerText="n\u00e9v hi\u00e1nyzik";f.innerText="error";a=l[c][0];c=A[a.o];r(b,"span",["material-symbols-outlined","extra"]).innerText="add_circle";const k=r(b,"a",["extra"]);k.target="_blank";k.innerText="n\u00e9v hozz\u00e1ad\u00e1sa";k.href=`${h.href}/taxon_names/new?taxon_name_name=${encodeURIComponent(e)}&taxon_name_audit_comment=${encodeURIComponent(L(c,
a.m))}`;D(b,[f,g])}else h.innerText="keres\u00e9s",h.href=`${"https://www.inaturalist.org"}/search?source[]=taxa&q=${encodeURIComponent(c)}`,m(b,["missing"])}const u=document.currentScript||Array.from(document.querySelectorAll("script[type=module]")).pop(),n=u.ownerDocument,q=n.head;setTimeout(function(){q.appendChild(v("https://fonts.gstatic.com",!0,!0));q.appendChild(v("https://fonts.googleapis.com",!0));q.appendChild(v("https://fonts.googleapis.com/css2?family=Inter&family=Noto+Serif:ital@1&family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0&display=swap"))},
0);"complete"===n.readyState||u.async||u.defer?G():n.addEventListener("DOMContentLoaded",()=>{G()});const A={},l={},I=[];class T{constructor(a){this.key=a}}class R{constructor(a,b,c){this.id=a;this.B=b;this.A=c.title;this.s=c.subtitle}}class S{constructor(a,b){this.o=a;this.m=b.page;this.j=b.scientific_name;this.u=b.synonyms||[];this.h=b.common_names}}let B=null,y="",M="",E=0;const aa=`${"https://www.inaturalist.org".replace(/www/,"api")}/v1`,z={};class F{constructor(a){this.l=a.total_results;this.v=
a.results.map(b=>new ca(b))}}class ca{constructor(a){this.id=a.id;this.name=a.name;this.g=a.preferred_common_name;a.default_photo&&(this.i=new da(a.default_photo))}}class da{constructor(a){this.attribution=a.attribution;this.C=a.square_url}}})();
